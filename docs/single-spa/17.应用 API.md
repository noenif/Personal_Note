---
layout: default
title:  åº”ç”¨ API
parent: single-spa
nav_order: 17
---

single-spa å¯¼å‡ºå‘½åå‡½æ•°å’Œå˜é‡ï¼Œè€Œä¸æ˜¯å•ä¸ªé»˜è®¤å¯¼å‡ºã€‚è¿™æ„å‘³ç€å¯¼å…¥å¿…é¡»ä»¥ä¸¤ç§æ–¹å¼ä¹‹ä¸€è¿›è¡Œï¼š

```javascript
import { registerApplication, start } from 'single-spa';
// or
import * as singleSpa from 'single-spa';
```

## æ³¨å†Œç”³è¯·[#](https://single-spa.js.org/docs/api/#registerapplication)

**registerApplication**æ˜¯æ‚¨çš„æ ¹é…ç½®å°†ä½¿ç”¨çš„æœ€é‡è¦çš„ APIã€‚ä½¿ç”¨æ­¤åŠŸèƒ½å¯åœ¨ single-spa ä¸­æ³¨å†Œä»»ä½•åº”ç”¨ç¨‹åºã€‚è¯·æ³¨æ„ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºæ˜¯ä»å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºå†…æ³¨å†Œçš„ï¼Œåˆ™åº”ç”¨ç¨‹åºä¹‹é—´å°†ä¸ä¼šä¿æŒå±‚æ¬¡ç»“æ„ã€‚

æœ‰ä¸¤ç§æ³¨å†Œåº”ç”¨ç¨‹åºçš„æ–¹æ³•ï¼š

### ç®€å•çš„å‚æ•°[#](https://single-spa.js.org/docs/api/#simple-å‚æ•°)

```javascript
singleSpa.registerApplication(
  'appName',
  () => System.import('appName'),
  location => location.pathname.startsWith('appName'),
);
```

### å‚æ•°

- appName: string

  single-spa å°†æ³¨å†Œå’Œå¼•ç”¨æ­¤åº”ç”¨ç¨‹åºçš„åº”ç”¨ç¨‹åºåç§°ï¼Œå¹¶å°†åœ¨å¼€å‘å·¥å…·ä¸­æ ‡è®°ã€‚

- applicationOrLoadingFn: () => <Function | Promise>

  å¿…é¡»æ˜¯ä¸€ä¸ªåŠ è½½å‡½æ•°ï¼Œå¯ä»¥è¿”å›å·²è§£æçš„åº”ç”¨ç¨‹åºæˆ–æ‰¿è¯ºã€‚

- activityFn: (location) => boolean

  å¿…é¡»æ˜¯çº¯å‡½æ•°ã€‚è¯¥å‡½æ•°è¢«è°ƒç”¨**window.location**ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåªè¦åº”ç”¨ç¨‹åºå¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå°±åº”è¯¥è¿”å›ä¸€ä¸ªçœŸå€¼ã€‚

- customProps?: Object | () => Object

  å°†åœ¨æ¯ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœŸé—´ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚

### è¿”å›

**undefined**

### é…ç½®å¯¹è±¡[#](https://single-spa.js.org/docs/api/#configuration-object)

```javascript
singleSpa.registerApplication({
    name: 'appName',
    app: () => System.import('appName'),
    activeWhen: '/appName',
    customProps: {
        authToken: 'xc67f6as87f7s9d'
    }
})

singleSpa.registerApplication({
    name: 'appName',
    app: () => System.import('appName'),
    activeWhen: '/appName',
    // Dynamic custom props that can change based on route
    customProps(appName, location) {
        return {
            authToken: 'xc67f6as87f7s9d'
        }
    }
})
```

### å‚æ•°

- name: string

  single-spa å°†æ³¨å†Œå’Œå¼•ç”¨æ­¤åº”ç”¨ç¨‹åºçš„åº”ç”¨ç¨‹åºåç§°ï¼Œå¹¶å°†åœ¨å¼€å‘å·¥å…·ä¸­æ ‡è®°ã€‚

- app: Application | () => Application | Promise<Application>

  åº”ç”¨ç¨‹åºå¯¹è±¡æˆ–è¿”å›å·²è§£å†³åº”ç”¨ç¨‹åºçš„å‡½æ•°ï¼ˆæ˜¯å¦æ‰¿è¯ºï¼‰

- activeWhen: string | (location) => boolean | (string | (location) => boolean)[]

  å¯ä»¥æ˜¯åŒ¹é…ä»¥æ­¤è·¯å¾„å¼€å¤´çš„æ¯ä¸ª URL çš„è·¯å¾„å‰ç¼€ã€æ´»åŠ¨å‡½æ•°ï¼ˆå¦‚ç®€å•å‚æ•°ä¸­æ‰€è¿°ï¼‰æˆ–åŒ…å«å®ƒä»¬çš„æ•°ç»„ã€‚å¦‚æœä»»ä½•æ¡ä»¶ä¸ºçœŸï¼Œå®ƒå°†ä½¿åº”ç”¨ç¨‹åºä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚è·¯å¾„å‰ç¼€ä¹Ÿæ¥å—åŠ¨æ€å€¼ï¼ˆå®ƒä»¬å¿…é¡»ä»¥ ':' å¼€å¤´ï¼‰ï¼Œå› ä¸ºæŸäº›è·¯å¾„ä¼šæ¥æ”¶ url å‚æ•°å¹¶ä¸”ä»åº”è§¦å‘æ‚¨çš„åº”ç”¨ç¨‹åºã€‚ä¾‹å­ï¼š'/app1'âœ… https://app.com/app1âœ… https://app.com/app1/anything/everythingğŸš« https://app.com/app2'/users/:userId/profile'âœ… https://app.com/users/123/profileâœ… https://app.com/users/123/profile/sub-profile/ğŸš« https://app.com/users//profile/sub-profile/ğŸš« https://app.com/users/profile/sub-profile/'/pathname/#/hash'âœ… https://app.com/pathname/#/hashâœ… https://app.com/pathname/#/hash/route/nestedğŸš« https://app.com/pathname#/hash/route/nestedğŸš« https://app.com/pathname#/another-hash['/pathname/#/hash', '/app1']âœ… https://app.com/pathname/#/hash/route/nestedâœ… https://app.com/app1/anything/everythingğŸš« https://app.com/pathname/app1ğŸš« https://app.com/app2

- customProps?: Object | () => Object

  å°†åœ¨æ¯ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœŸé—´ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚

### è¿”å›

**undefined**

##### ç¬”è®°

é‡Œé¢æœ‰è¯¦ç»†çš„ä»‹ç» [Configuration docs](https://single-spa.js.org/docs/api/configuration#registering-applications)

## å¼€å§‹[#](https://single-spa.js.org/docs/api/#start)

```javascript
singleSpa.start();

// Optionally, you can provide configuration
singleSpa.start({
  urlRerouteOnly: true,
});
```

å¿…é¡»ç”±æ‚¨çš„single-spa é…ç½®è°ƒç”¨ã€‚å‰**start**è¢«è°ƒç”¨ï¼Œåº”ç”¨ç¨‹åºå°†è¢«åŠ è½½ï¼Œä½†æ°¸è¿œä¸ä¼šè¢«å¼•å¯¼ã€æŒ‚è½½æˆ–å¸è½½ã€‚çš„åŸå› **start**æ˜¯è®©æ‚¨æ§åˆ¶å•é¡µåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ç«‹å³å£°æ˜å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºï¼ˆä»¥å¼€å§‹ä¸‹è½½æ´»åŠ¨åº”ç”¨ç¨‹åºçš„ä»£ç ï¼‰ï¼Œä½†åœ¨åˆå§‹ AJAX è¯·æ±‚ï¼ˆå¯èƒ½æ˜¯è·å–æœ‰å…³ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼‰å®Œæˆä¹‹å‰ä¸å®é™…æŒ‚è½½å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„æ€§èƒ½æ˜¯é€šè¿‡è°ƒç”¨**registerApplication** ç«‹å³ï¼Œä½†è°ƒç”¨ **start** AJAX è¯·æ±‚å®Œæˆåã€‚

### å‚æ•°

è¿™ **start(opts)** api å¯é€‰æ‹©æ¥å—å•ä¸ª **opts**å¯¹è±¡ï¼Œå…·æœ‰ä»¥ä¸‹å±æ€§ã€‚å¦‚æœçœç•¥ opts å¯¹è±¡ï¼Œåˆ™å°†åº”ç”¨æ‰€æœ‰é»˜è®¤å€¼ã€‚

- **urlRerouteOnly**: é»˜è®¤ä¸º false çš„å¸ƒå°”å€¼ã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™è°ƒç”¨**history.pushState()** å’Œ **history.replaceState()**é™¤éå®¢æˆ·ç«¯è·¯ç”±å‘ç”Ÿæ›´æ”¹ï¼Œå¦åˆ™ä¸ä¼šè§¦å‘ single-spa é‡æ–°è·¯ç”±ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°†æ­¤è®¾ç½®ä¸º true å¯ä»¥æ›´å¥½åœ°æé«˜æ€§èƒ½ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»[original issue](https://github.com/single-spa/single-spa/issues/484).

### è¿”å›

**undefined**

## è§¦å‘åº”ç”¨ç¨‹åºæ›´æ”¹[#](https://single-spa.js.org/docs/api/#triggerappchange)

```javascript
singleSpa.triggerAppChange();
```

è¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼Œå½“æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å·²å®‰è£…/å¸è½½æ—¶ï¼Œè¯¥æ‰¿è¯ºå°†è§£å†³/æ‹’ç»ã€‚è¿™æ˜¯ä¸ºæµ‹è¯• single-spa è€Œæ„å»ºçš„ï¼Œåœ¨ç”Ÿäº§åº”ç”¨ç¨‹åºä¸­å¯èƒ½ä¸éœ€è¦ã€‚

### å‚æ•°

æ²¡æœ‰ä»»ä½•

### è¿”å›

- Promise

  è¿”å›å°†åœ¨æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å®‰è£…åè§£å†³/æ‹’ç»çš„æ‰¿è¯ºã€‚

## å¯¼èˆªåˆ°ç½‘å€[#](https://single-spa.js.org/docs/api/#navigatetourl)

```javascript
// Three ways of using navigateToUrl
singleSpa.navigateToUrl('/new-url');
singleSpa.navigateToUrl(document.querySelector('a'));
document.querySelector('a').addEventListener(singleSpa.navigateToUrl);
```

```javascript
<!-- A fourth way to use navigateToUrl, this one inside of your HTML -->
<a href="/new-url" onclick="singleSpaNavigate(event)">My link</a>
```

ä½¿ç”¨æ­¤å®ç”¨åŠŸèƒ½å¯ä»¥è½»æ¾åœ°åœ¨å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œ url å¯¼èˆªï¼Œè€Œæ— éœ€å¤„ç† **event.preventDefault()**, **pushState**, **triggerAppChange()**ï¼Œ ç­‰ç­‰ã€‚

### å‚æ•°

- navigationObj: string | context | DOMEvent

  navigationObj å¿…é¡»æ˜¯ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼šä¸€ä¸ªç½‘å€å­—ç¬¦ä¸²ã€‚ä¸€ä¸ªä¸Šä¸‹æ–‡ / thisArg å…·æœ‰ **href**è´¢äº§; é€šè¯æ—¶æœ‰ç”¨**singleSpaNavigate.call(anchorElement)** å¼•ç”¨é”šå…ƒç´ æˆ–å…¶ä»–ä¸Šä¸‹æ–‡ã€‚DOMElement ä¸Šå•å‡»äº‹ä»¶çš„ DOMEvent å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å…·æœ‰ **href**å±æ€§; éå¸¸é€‚åˆ**<a onclick="singleSpaNavigate"></a>** ç”¨ä¾‹ã€‚

### è¿”å›

**undefined**

## è·å–æŒ‚è½½åº”ç”¨ç¨‹åº[#](https://single-spa.js.org/docs/api/#getmountedapps)

```javascript
const mountedAppNames = singleSpa.getMountedApps();
console.log(mountedAppNames); // ['app1', 'app2', 'navbar']
```

### å‚æ•°

æ²¡æœ‰ä»»ä½•

### è¿”å›

- appNames: string[]

  æ¯ä¸ªå­—ç¬¦ä¸²æ˜¯å½“å‰æ³¨å†Œçš„åº”ç”¨ç¨‹åºçš„åç§° **MOUNTED**.

## è·å–åº”ç”¨åç§°[#](https://single-spa.js.org/docs/api/#getappnames)

```javascript
const appNames = singleSpa.getAppNames();
console.log(appNames); // ['app1', 'app2', 'app3', 'navbar']
```

### å‚æ•°

æ²¡æœ‰ä»»ä½•

### è¿”å›

- appNames: string[]

  æ— è®ºåº”ç”¨ç¨‹åºçŠ¶æ€å¦‚ä½•ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯å·²æ³¨å†Œåº”ç”¨ç¨‹åºçš„åç§°ã€‚

## è·å–åº”ç”¨ç¨‹åºçŠ¶æ€[#](https://single-spa.js.org/docs/api/#getappstatus)

```javascript
const status = singleSpa.getAppStatus('app1');
console.log(status); // one of many statuses (see list below). e.g. MOUNTED
```

### å‚æ•°

- appName: string

  æ³¨å†Œçš„åº”ç”¨ç¨‹åºåç§°ã€‚

### è¿”å›

- appStatus: <string | null>

  å°†æ˜¯ä»¥ä¸‹å­—ç¬¦ä¸²å¸¸é‡ä¹‹ä¸€ï¼Œæˆ– **null** å¦‚æœåº”ç”¨ç¨‹åºä¸å­˜åœ¨ã€‚NOT_LOADEDåº”ç”¨ç¨‹åºå·²åœ¨ single-spa æ³¨å†Œä½†å°šæœªåŠ è½½ã€‚LOADING_SOURCE_CODEæ­£åœ¨è·å–åº”ç”¨ç¨‹åºçš„æºä»£ç ã€‚NOT_BOOTSTRAPPEDåº”ç”¨ç¨‹åºå·²åŠ è½½ä½†æœªå¯åŠ¨ã€‚BOOTSTRAPPINGè¿™ **bootstrap** ç”Ÿå‘½å‘¨æœŸå‡½æ•°å·²è¢«è°ƒç”¨ä½†å°šæœªå®Œæˆã€‚NOT_MOUNTEDåº”ç”¨ç¨‹åºå·²åŠ è½½å¹¶å¼•å¯¼ä½†å°šæœªå®‰è£…ã€‚MOUNTINGåº”ç”¨ç¨‹åºæ­£åœ¨å®‰è£…ä½†å°šæœªå®Œæˆã€‚MOUNTEDåº”ç”¨ç¨‹åºå½“å‰å¤„äºæ´»åŠ¨çŠ¶æ€å¹¶æŒ‚è½½åˆ° DOMã€‚UNMOUNTINGåº”ç”¨ç¨‹åºå½“å‰æ­£åœ¨å¸è½½ä½†å°šæœªå®Œæˆã€‚UNLOADINGåº”ç”¨ç¨‹åºå½“å‰æ­£åœ¨å¸è½½ä½†å°šæœªå®Œæˆã€‚SKIP_BECAUSE_BROKENåº”ç”¨ç¨‹åºåœ¨åŠ è½½ã€å¼•å¯¼ã€æŒ‚è½½æˆ–å¸è½½æœŸé—´æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸”ç”±äºè¡Œä¸ºä¸ç«¯è€Œè¢«å­¤ç«‹å¹¶è¢«è·³è¿‡ã€‚å…¶ä»–åº”ç”¨ç¨‹åºå°†ç»§ç»­æ­£å¸¸è¿è¡Œã€‚LOAD_ERRORåº”ç”¨ç¨‹åºçš„åŠ è½½å‡½æ•°è¿”å›äº†ä¸€ä¸ªè¢«æ‹’ç»çš„æ‰¿è¯ºã€‚è¿™é€šå¸¸æ˜¯ç”±äºå°è¯•ä¸‹è½½åº”ç”¨ç¨‹åºçš„ JavaScript åŒ…æ—¶å‡ºç°ç½‘ç»œé”™è¯¯ã€‚Single-spa å°†åœ¨ç”¨æˆ·å¯¼èˆªç¦»å¼€å½“å‰è·¯çº¿ç„¶åè¿”å›å®ƒåé‡è¯•åŠ è½½åº”ç”¨ç¨‹åºã€‚

### å¤„ç† LOAD_ERROR çŠ¶æ€ä»¥é‡è¯•æ¨¡å—[#](https://single-spa.js.org/docs/api/#handling-load_error-status-to-retry-module)

å¦‚æœæ¨¡å—åŠ è½½å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œç”±äºç½‘ç»œé”™è¯¯ï¼‰ï¼Œsingle-spa ä¼šå¤„ç†é”™è¯¯ï¼Œä½† SystemJS ä¸ä¼šç¨åè‡ªåŠ¨é‡è¯•ä¸‹è½½æ¨¡å—ã€‚ä¸ºæ­¤ï¼Œæ·»åŠ ä¸€ä¸ªsingle-spaerrorHandler ä»¥ä» SystemJS æ³¨å†Œè¡¨ä¸­åˆ é™¤è¯¥æ¨¡å—ï¼Œå¹¶åœ¨ä»¥ä¸‹æƒ…å†µä¸‹é‡æ–°å°è¯•ä¸‹è½½è¯¥æ¨¡å—**System.import()** åœ¨ç”³è¯·ä¸­ **LOAD_ERROR** çŠ¶æ€å†æ¬¡è¢«è°ƒç”¨ã€‚

```javascript
singleSpa.addErrorHandler(err => {
  if (singleSpa.getAppStatus(err.appOrParcelName) === singleSpa.LOAD_ERROR) {
    System.delete(System.resolve(err.appOrParcelName));
  }
});
```

## å¸è½½åº”ç”¨ç¨‹åº[#](https://single-spa.js.org/docs/api/#unloadapplication)

```javascript
// Unload the application right now, without waiting for it to naturally unmount.
singleSpa.unloadApplication('app1');

// Unload the application only after it naturally unmounts due to a route change.
singleSpa.unloadApplication('app1', { waitForUnmount: true });
```

å¸è½½å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºçš„ç›®çš„æ˜¯å°†å…¶è®¾ç½®å› NOT_LOADED çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å®ƒå°†åœ¨ä¸‹æ¬¡éœ€è¦æŒ‚è½½æ—¶é‡æ–°å¼•å¯¼ã€‚å…¶ä¸»è¦ç”¨ä¾‹æ˜¯å…è®¸çƒ­é‡æ–°åŠ è½½æ•´ä¸ªæ³¨å†Œçš„åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯**unloadApplication** æ¯å½“æ‚¨æƒ³é‡æ–°å¼•å¯¼æ‚¨çš„åº”ç”¨ç¨‹åºæ—¶éƒ½éå¸¸æœ‰ç”¨ã€‚

è°ƒç”¨ unloadApplication æ—¶ï¼ŒSingle-spa æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ã€‚

1. æ‰“ç”µè¯ç»™ [unload lifecyle](https://single-spa.js.org/docs/api#unload) åœ¨æ­£åœ¨å¸è½½çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºä¸Šã€‚
2. å°†åº”ç”¨çŠ¶æ€è®¾ç½®ä¸º NOT_LOADED
3. è§¦å‘é‡æ–°è·¯ç”±ï¼Œåœ¨æ­¤æœŸé—´ single-spa å¯èƒ½ä¼šæŒ‚è½½åˆšåˆšå¸è½½çš„åº”ç”¨ç¨‹åºã€‚

å› ä¸ºæ³¨å†Œçš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šåœ¨ **unloadApplication**è¢«è°ƒç”¨æ—¶ï¼Œæ‚¨å¯ä»¥æŒ‡å®šæ˜¯è¦ç«‹å³å¸è½½è¿˜æ˜¯è¦ç­‰åˆ°åº”ç”¨ç¨‹åºä¸å†å®‰è£…ã€‚è¿™æ˜¯é€šè¿‡**waitForUnmount** é€‰é¡¹ã€‚

### å‚æ•°

- appName: string

  æ³¨å†Œçš„åº”ç”¨ç¨‹åºåç§°ã€‚

- options?: {waitForUnmount: boolean = false}

  é€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå…·æœ‰ **waitForUnmount**è´¢äº§ã€‚ä»€ä¹ˆæ—¶å€™**waitForUnmount** æ˜¯ **false**, å³ä½¿åº”ç”¨ç¨‹åºå½“å‰å·²å®‰è£…ï¼Œsingle-spa ä¹Ÿä¼šç«‹å³å¸è½½æŒ‡å®šçš„æ³¨å†Œåº”ç”¨ç¨‹åºã€‚å¦‚æœæ˜¯**true**, single-spa å°†åœ¨å®‰å…¨çš„æƒ…å†µä¸‹å°½å¿«å¸è½½å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºï¼ˆå½“åº”ç”¨ç¨‹åºçŠ¶æ€ä¸æ˜¯ **MOUNTED**ï¼‰ã€‚

### è¿”å›

- Promise

  å½“å·²æˆåŠŸå¸è½½å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºæ—¶ï¼Œå°†è§£å†³æ­¤æ‰¿è¯ºã€‚

## æ³¨é”€ç”³è¯·[#](https://single-spa.js.org/docs/api/#unregisterapplication)

```javascript
import { unregisterApplication } from 'single-spa';

unregisterApplication('app1').then(() => {
  console.log('app1 is now unmounted, unloaded, and no longer registered!');
});
```

è¿™ **unregisterApplication**å‡½æ•°å°†å¸è½½ã€å¸è½½å’Œæ³¨é”€åº”ç”¨ç¨‹åºã€‚ä¸€æ—¦ä¸å†æ³¨å†Œï¼Œè¯¥åº”ç”¨ç¨‹åºå°†æ°¸è¿œä¸ä¼šå†è¢«æŒ‚è½½ã€‚

è¿™ä¸ªapiæ˜¯åœ¨ [single-spa@5.8.0.](mailto:single-spa@5.8.0.) å…³äºè¿™ä¸ªapiçš„ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š

- å–æ¶ˆæ³¨å†Œåº”ç”¨ç¨‹åºä¸ä¼šå°†å…¶ä» SystemJS æ¨¡å—æ³¨å†Œè¡¨ä¸­åˆ é™¤ã€‚
- å–æ¶ˆæ³¨å†Œåº”ç”¨ç¨‹åºä¸ä¼šä»æµè§ˆå™¨å†…å­˜ä¸­åˆ é™¤å…¶ä»£ç æˆ– JavaScript æ¡†æ¶ã€‚
- å–æ¶ˆæ³¨å†Œåº”ç”¨ç¨‹åºçš„å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨åº”ç”¨ç¨‹åºçš„æ´»åŠ¨åŠŸèƒ½å†…æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚è¿™å…·æœ‰é˜²æ­¢åº”ç”¨ç¨‹åºæ°¸è¿œå®‰è£…çš„ç±»ä¼¼æ•ˆæœã€‚

### å‚æ•°

- appName: string

### è¿”å›

- Promise

  æ­¤æ‰¿è¯ºå°†åœ¨åº”ç”¨ç¨‹åºæˆåŠŸæ³¨é”€åå¾—åˆ°è§£å†³ã€‚

## æ£€æŸ¥æ´»åŠ¨å‡½æ•°[#](https://single-spa.js.org/docs/api/#checkactivityfunctions)

```javascript
const appsThatShouldBeActive = singleSpa.checkActivityFunctions();
console.log(appsThatShouldBeActive); // ['app1']

const appsForACertainRoute = singleSpa.checkActivityFunctions(new URL('/app2', window.location.href));
console.log(appsForACertainRoute); // ['app2']
```

å°†è°ƒç”¨æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æ´»åŠ¨åŠŸèƒ½ **url** å¹¶ä¸ºæ‚¨æä¾›åº”åœ¨è¯¥ä½ç½®å®‰è£…å“ªäº›åº”ç”¨ç¨‹åºçš„åˆ—è¡¨ã€‚

### å‚æ•°

- url: URL

  ä¸€ç§ **URL** åœ¨è°ƒç”¨æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æ´»åŠ¨å‡½æ•°ä»¥æµ‹è¯•å®ƒä»¬æ˜¯å¦è¿”å› true æ—¶ï¼Œå°†ä»£æ›¿ window.location ä½¿ç”¨çš„å¯¹è±¡ã€‚

### è¿”å›

- appNames: string[]

  æ¯ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æä¾›çš„åŒ¹é…çš„æ³¨å†Œåº”ç”¨ç¨‹åºçš„åç§° **url**.

## æ·»åŠ é”™è¯¯å¤„ç†ç¨‹åº[#](https://single-spa.js.org/docs/api/#adderrorhandler)

```javascript
singleSpa.addErrorHandler(err => {
  console.log(err);
  console.log(err.appOrParcelName);
  console.log(singleSpa.getAppStatus(err.appOrParcelName));
});
```

æ·»åŠ ä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œæ¯æ¬¡åº”ç”¨ç¨‹åºåœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°æˆ–æ´»åŠ¨å‡½æ•°æœŸé—´æŠ›å‡ºé”™è¯¯æ—¶éƒ½ä¼šè°ƒç”¨è¯¥å¤„ç†ç¨‹åºã€‚å½“æ²¡æœ‰é”™è¯¯å¤„ç†ç¨‹åºæ—¶ï¼Œsingle-spa å°†é”™è¯¯æŠ›å‡ºåˆ°çª—å£ã€‚

- errorHandler: Function(error: Error)

  å¿…é¡»æ˜¯å‡½æ•°ã€‚å°†è¢«è°ƒç”¨[Error object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error) å¦å¤–è¿˜æœ‰ä¸€ä¸ª **message** å’Œ **appOrParcelName** è´¢äº§ã€‚

### è¿”å›

**undefined**

## åˆ é™¤é”™è¯¯å¤„ç†ç¨‹åº[#](https://single-spa.js.org/docs/api/#removeerrorhandler)

```javascript
singleSpa.addErrorHandler(handleErr);
singleSpa.removeErrorHandler(handleErr);

function handleErr(err) {
  console.log(err);
}
```

åˆ é™¤ç»™å®šçš„é”™è¯¯å¤„ç†å‡½æ•°ã€‚

### å‚æ•°

- errorHandler: Function

  å‚è€ƒé”™è¯¯å¤„ç†å‡½æ•°ã€‚

### è¿”å›

- boolean

  **true** å¦‚æœé”™è¯¯å¤„ç†ç¨‹åºè¢«åˆ é™¤ï¼Œå¹¶ä¸” **false** å¦‚æœä¸æ˜¯ã€‚

## æŒ‚è½½æ ¹åŒ…è£¹[#](https://single-spa.js.org/docs/api/#mountrootparcel)

```javascript
// Synchronous mounting
const parcel = singleSpa.mountRootParcel(parcelConfig, {
  prop1: 'value1',
  domElement: document.getElementById('a-div'),
});
parcel.mountPromise.then(() => {
  console.log('finished mounting the parcel!');
});

// Asynchronous mounting. Feel free to use webpack code splits or SystemJS dynamic loading
const parcel2 = singleSpa.mountRootParcel(() => import('./some-parcel.js'), {
  prop1: 'value1',
  domElement: document.getElementById('a-div'),
});
```

å°†åˆ›å»ºå¹¶æŒ‚è½½ä¸€ä¸ª [single-spa parcel](https://single-spa.js.org/docs/parcels-overview).

##### åŒ…è£¹ä¸ä¼šè‡ªåŠ¨å¸è½½

å¸è½½éœ€è¦æ‰‹åŠ¨è§¦å‘ã€‚

### å‚æ•°

- parcelConfig: Object or Loading Function

  [parcelConfig](/docs/parcels-api#parcel-configuration)

- parcelProps: Object with a domElement property

  [parcelProps](/docs/parcels-api#parcel-props)

### è¿”å›

- Parcel object

  çœ‹ [Parcels API](https://single-spa.js.org/docs/parcels-api.html) äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

## æ´»åŠ¨è·¯å¾„[#](https://single-spa.js.org/docs/api/#pathtoactivewhen)

è¿™ **pathToActiveWhen** å‡½æ•°å°†å­—ç¬¦ä¸² URL è·¯å¾„è½¬æ¢ä¸º [activity function](https://single-spa.js.org/docs/configuration/#activity-function). å­—ç¬¦ä¸²è·¯å¾„å¯èƒ½åŒ…å«è·¯ç”±å‚æ•°ï¼Œsingle-spa å°†åŒ¹é…ä»»ä½•å­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ pathToActiveWhen å‡å®šæä¾›çš„å­—ç¬¦ä¸²æ˜¯**å‰ç¼€**ï¼›ä½†æ˜¯ï¼Œè¿™å¯ä»¥é€šè¿‡**exactMatch** èŒƒå›´ã€‚

å½“å­—ç¬¦ä¸²ä¼ å…¥æ—¶ï¼Œæ­¤å‡½æ•°ç”± single-spa ä½¿ç”¨ **registerApplication** ä½œä¸º **activeWhen** å‚æ•°ã€‚

***å‚æ•°\***

1. **path** (string): URL å‰ç¼€ã€‚
2. **exactMatch** ï¼ˆå¸ƒå°”å€¼ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º **false**, éœ€è¦ single-spa@>=5.9.0)ï¼šä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ§åˆ¶æ˜¯å¦åº”è¯¥å…è®¸è·¯å¾„åé¢çš„å°¾éšå­—ç¬¦ã€‚ä»€ä¹ˆæ—¶å€™**false**, å°¾éšå­—ç¬¦æ˜¯å…è®¸çš„ã€‚ä»€ä¹ˆæ—¶å€™**true**, å°¾éšå­—ç¬¦æ˜¯ä¸å…è®¸çš„ã€‚

***è¿”å›å€¼\***

**(url: URL) => boolean**

æ¥å—ä¸€ä¸ªå‡½æ•° **URL** object ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºè·¯å¾„æ˜¯å¦ä¸è¯¥ URL åŒ¹é…ã€‚

***ä¾‹å­ï¼š\***

```javascript
let activeWhen = singleSpa.pathToActiveWhen('/settings');
activewhen(new URL('http://localhost/settings')); // true
activewhen(new URL('http://localhost/settings/password')); // true
activeWhen(new URL('http://localhost/')); // false

activeWhen = singleSpa.pathToActiveWhen('/users/:id/settings');
activewhen(new URL('http://localhost/users/6f7dsdf8g9df8g9dfg/settings')); // true
activewhen(new URL('http://localhost/users/1324/settings')); // true
activewhen(new URL('http://localhost/users/1324/settings/password')); // true
activewhen(new URL('http://localhost/users/1/settings')); // true
activewhen(new URL('http://localhost/users/1')); // false
activewhen(new URL('http://localhost/settings')); // false
activeWhen(new URL('http://localhost/')); // false

activeWhen = singleSpa.pathToActiveWhen('/page#/hash');
activeWhen(new URL('http://localhost/page#/hash')); // true
activeWhen(new URL('http://localhost/#/hash')); // false
activeWhen(new URL('http://localhost/page')); // false
```

## ç¡®ä¿JQueryæ”¯æŒ[#](https://single-spa.js.org/docs/api/#ensurejquerysupport)

```javascript
singleSpa.ensureJQuerySupport(jQuery);
```

jQuery ä½¿ç”¨ [event delegation](https://learn.jquery.com/events/event-delegation/)æ‰€ä»¥ single-spa å¿…é¡»å¯¹é¡µé¢ä¸Šçš„æ¯ä¸ª jQuery ç‰ˆæœ¬è¿›è¡ŒçŒ´å­è¡¥ä¸ã€‚single-spa å°†å°è¯•é€šè¿‡æŸ¥æ‰¾æ¥è‡ªåŠ¨æ‰§è¡Œæ­¤æ“ä½œ**window.jQuery** æˆ–è€… **window.$**. å¦‚æœé¡µé¢ä¸ŠåŒ…å«å¤šä¸ªç‰ˆæœ¬æˆ–è€… jQuery ç»‘å®šåˆ°ä¸åŒçš„å…¨å±€å˜é‡ï¼Œè¯·ä½¿ç”¨æ­¤æ˜¾å¼æ–¹æ³•ã€‚

### å‚æ•°

- jQuery?: JQueryFn = window.jQuery

  å¯¹ jQuery ç»‘å®šåˆ°çš„å…¨å±€å˜é‡çš„å¼•ç”¨ã€‚

### è¿”å›

**undefined**

## è®¾ç½®BootstrapMaxTime[#](https://single-spa.js.org/docs/api/#setbootstrapmaxtime)

```javascript
// After three seconds, show a console warning while continuing to wait.
singleSpa.setBootstrapMaxTime(3000);

// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.
singleSpa.setBootstrapMaxTime(3000, true);

// don't do a console warning for slow lifecycles until 10 seconds have elapsed
singleSpa.setBootstrapMaxTime(3000, true, 10000);
```

è®¾ç½®å¼•å¯¼è¶…æ—¶çš„å…¨å±€é…ç½®ã€‚

### å‚æ•°

- millis: number

  è¶…æ—¶å‰ç­‰å¾…å¼•å¯¼ç¨‹åºå®Œæˆçš„æ¯«ç§’æ•°ã€‚

- dieOnTimeout: boolean = false

  å¦‚æœä¸º falseï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºåªä¼šåœ¨æ§åˆ¶å°ä¸­å¼•èµ·ä¸€äº›è­¦å‘Šï¼Œç›´åˆ° **millis** åˆ°è¾¾äº†ã€‚å¦‚æœä¸ºçœŸï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºå°†è¢«å­¤ç«‹åˆ° SKIP_BECAUSE_BROKEN çŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå®ƒä»¬å°†å†ä¹Ÿæ²¡æœ‰æœºä¼šç ´åä¸€åˆ‡ã€‚æ¯ä¸ªæ³¨å†Œçš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä¸ºè‡ªå·±è¦†ç›–æ­¤è¡Œä¸ºã€‚

- warningMillis: number = 1000

  åœ¨æœ€ç»ˆè¶…æ—¶ä¹‹å‰å‘ç”Ÿçš„æ§åˆ¶å°è­¦å‘Šä¹‹é—´ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚

### è¿”å›

**undefined**

## è®¾ç½®æœ€å¤§æ—¶é—´[#](https://single-spa.js.org/docs/api/#setmountmaxtime)

```javascript
// After three seconds, show a console warning while continuing to wait.
singleSpa.setMountMaxTime(3000);

// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.
singleSpa.setMountMaxTime(3000, true);

// don't do a console warning for slow lifecycles until 10 seconds have elapsed
singleSpa.setMountMaxTime(3000, true, 10000);
```

è®¾ç½®æŒ‚è½½è¶…æ—¶çš„å…¨å±€é…ç½®ã€‚

### å‚æ•°

- millis: number

  è¶…æ—¶å‰ç­‰å¾…æŒ‚è½½å®Œæˆçš„æ¯«ç§’æ•°ã€‚

- dieOnTimeout: boolean = false

  å¦‚æœä¸º falseï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºåªä¼šåœ¨æ§åˆ¶å°ä¸­å¼•èµ·ä¸€äº›è­¦å‘Šï¼Œç›´åˆ° **millis** åˆ°è¾¾äº†ã€‚å¦‚æœä¸ºçœŸï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºå°†è¢«å­¤ç«‹åˆ° SKIP_BECAUSE_BROKEN çŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå®ƒä»¬å°†å†ä¹Ÿæ²¡æœ‰æœºä¼šç ´åä¸€åˆ‡ã€‚æ¯ä¸ªæ³¨å†Œçš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä¸ºè‡ªå·±è¦†ç›–æ­¤è¡Œä¸ºã€‚

- warningMillis: number = 1000

  åœ¨æœ€ç»ˆè¶…æ—¶ä¹‹å‰å‘ç”Ÿçš„æ§åˆ¶å°è­¦å‘Šä¹‹é—´ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚

### è¿”å›

**undefined**

## è®¾ç½®å¸è½½æœ€å¤§æ—¶é—´[#](https://single-spa.js.org/docs/api/#setunmountmaxtime)

```javascript
// After three seconds, show a console warning while continuing to wait.
singleSpa.setUnmountMaxTime(3000);

// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.
singleSpa.setUnmountMaxTime(3000, true);

// don't do a console warning for slow lifecycles until 10 seconds have elapsed
singleSpa.setUnmountMaxTime(3000, true, 10000);
```

è®¾ç½®å¸è½½è¶…æ—¶çš„å…¨å±€é…ç½®ã€‚

### å‚æ•°

- millis: number

  è¶…æ—¶å‰ç­‰å¾…å¸è½½å®Œæˆçš„æ¯«ç§’æ•°ã€‚

- dieOnTimeout: boolean = false

  å¦‚æœä¸º falseï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºåªä¼šåœ¨æ§åˆ¶å°ä¸­å¼•èµ·ä¸€äº›è­¦å‘Šï¼Œç›´åˆ° **millis** åˆ°è¾¾äº†ã€‚å¦‚æœä¸ºçœŸï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºå°†è¢«å­¤ç«‹åˆ° SKIP_BECAUSE_BROKEN çŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå®ƒä»¬å°†å†ä¹Ÿæ²¡æœ‰æœºä¼šç ´åä¸€åˆ‡ã€‚æ¯ä¸ªæ³¨å†Œçš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä¸ºè‡ªå·±è¦†ç›–æ­¤è¡Œä¸ºã€‚

- warningMillis: number = 1000

  åœ¨æœ€ç»ˆè¶…æ—¶ä¹‹å‰å‘ç”Ÿçš„æ§åˆ¶å°è­¦å‘Šä¹‹é—´ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚

### è¿”å›

**undefined**

------

## è®¾ç½®å¸è½½æœ€å¤§æ—¶é—´[#](https://single-spa.js.org/docs/api/#setunloadmaxtime)

```javascript
// After three seconds, show a console warning while continuing to wait.
singleSpa.setUnloadMaxTime(3000);

// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.
singleSpa.setUnloadMaxTime(3000, true);

// don't do a console warning for slow lifecycles until 10 seconds have elapsed
singleSpa.setUnloadMaxTime(3000, true, 10000);
```

è®¾ç½®å¸è½½è¶…æ—¶çš„å…¨å±€é…ç½®ã€‚

### å‚æ•°

- millis: number

  è¶…æ—¶å‰ç­‰å¾…å¸è½½å®Œæˆçš„æ¯«ç§’æ•°ã€‚

- dieOnTimeout: boolean = false

  å¦‚æœä¸º falseï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºåªä¼šåœ¨æ§åˆ¶å°ä¸­å¼•èµ·ä¸€äº›è­¦å‘Šï¼Œç›´åˆ° **millis** åˆ°è¾¾äº†ã€‚å¦‚æœä¸ºçœŸï¼Œåˆ™æ­£åœ¨å‡æ…¢é€Ÿåº¦çš„å·²æ³¨å†Œåº”ç”¨ç¨‹åºå°†è¢«å­¤ç«‹åˆ° SKIP_BECAUSE_BROKEN çŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå®ƒä»¬å°†å†ä¹Ÿæ²¡æœ‰æœºä¼šç ´åä¸€åˆ‡ã€‚æ¯ä¸ªæ³¨å†Œçš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä¸ºè‡ªå·±è¦†ç›–æ­¤è¡Œä¸ºã€‚

- warningMillis: number = 1000

  åœ¨æœ€ç»ˆè¶…æ—¶ä¹‹å‰å‘ç”Ÿçš„æ§åˆ¶å°è­¦å‘Šä¹‹é—´ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚

### è¿”å›

**undefined**

## æ´»åŠ¨[#](https://single-spa.js.org/docs/api/#events)

single-spa å°†äº‹ä»¶å‘é€åˆ° **window** ä½œä¸ºæ‚¨çš„ä»£ç æŒ‚é’© URL è½¬æ¢çš„ä¸€ç§æ–¹å¼ã€‚

### æµè¡ŒçŠ¶æ€äº‹ä»¶[#](https://single-spa.js.org/docs/api/#popstateevent)

single-spaç«ç¾ [PopStateEvent](https://developer.mozilla.org/en-US/docs/Web/API/PopStateEvent)å½“å®ƒæƒ³è¦æŒ‡ç¤ºæ‰€æœ‰æ´»åŠ¨çš„åº”ç”¨ç¨‹åºé‡æ–°æ¸²æŸ“æ—¶çš„äº‹ä»¶ã€‚å½“ä¸€ä¸ªåº”ç”¨ç¨‹åºè°ƒç”¨æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µ[history.pushState](https://developer.mozilla.org/en-US/docs/Web/API/History/pushState), [history.replaceState](https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState)ï¼Œ æˆ–è€… [triggerAppChange](https://single-spa.js.org/docs/api/#triggerAppChange). Single-spa åœ¨æŸäº›æƒ…å†µä¸‹ä¼šåç¦»æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œå¦‚[this Github issue](https://github.com/single-spa/single-spa/issues/484#issuecomment-601279869).

```javascript
window.addEventListener('popstate', evt => {
  if (evt.singleSpa) {
    console.log(
      'This event was fired by single-spa to forcibly trigger a re-render',
    );
    console.log(evt.singleSpaTrigger); // pushState | replaceState
  } else {
    console.log('This event was fired by native browser behavior');
  }
});
```

### å–æ¶ˆå¯¼èˆª[#](https://single-spa.js.org/docs/api/#canceling-navigation)

å–æ¶ˆå¯¼èˆªæ˜¯æŒ‡ URL å‘ç”Ÿå˜åŒ–ï¼Œç„¶åç«‹å³å˜å›åŸæ¥çš„çŠ¶æ€ã€‚è¿™æ˜¯åœ¨ä»»ä½•å®‰è£…ã€å¸è½½æˆ–åŠ è½½ä¹‹å‰å®Œæˆçš„ï¼Œå¦åˆ™ä¼šå‘ç”Ÿã€‚è¿™å¯ä»¥ä¸ Vue è·¯ç”±å™¨å’Œ Angular è·¯ç”±å™¨çš„å†…ç½®å¯¼èˆªå®ˆå«ç»“åˆä½¿ç”¨ï¼Œå…è®¸å–æ¶ˆå¯¼èˆªäº‹ä»¶ã€‚

è¦å–æ¶ˆå¯¼èˆªäº‹ä»¶ï¼Œè¯·æ”¶å¬ **single-spa:before-routing-event** äº‹ä»¶ï¼š

```javascript
window.addEventListener(
  'single-spa:before-routing-event',
  ({ detail: { oldUrl, newUrl, cancelNavigation } }) => {
    if (
      new URL(oldUrl).pathname === '/route1' &&
      new URL(newUrl).pathname === '/route2'
    ) {
      cancelNavigation();
    }
  },
);
```

å–æ¶ˆå¯¼èˆªæ—¶ï¼Œå°†ä¸ä¼šå®‰è£…ã€å¸è½½ã€åŠ è½½æˆ–å¸è½½ä»»ä½•åº”ç”¨ç¨‹åºã€‚æ‰€æœ‰single-spaè·¯ç”±äº‹ä»¶éƒ½ä¼šä¸ºå–æ¶ˆçš„å¯¼èˆªè§¦å‘ï¼Œä½†å®ƒä»¬æ¯ä¸ªéƒ½æœ‰**navigationIsCanceled** å±æ€§è®¾ç½®ä¸º **true** åœ¨ **event.detail** ï¼ˆä»¥ä¸‹è‡ªå®šä¹‰äº‹ä»¶éƒ¨åˆ†çš„è¯¦ç»†ä¿¡æ¯ï¼‰ã€‚

å¯¼èˆªå–æ¶ˆæœ‰æ—¶ç”¨ä½œä¸€ç§æœºåˆ¶ï¼Œç”¨äºé˜²æ­¢ç”¨æˆ·è®¿é—®æœªç»æˆæƒçš„è·¯çº¿ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®å¯¹æ¯æ¡è·¯çº¿è¿›è¡Œæƒé™æ£€æŸ¥ï¼Œä½œä¸ºä¿æŠ¤è·¯çº¿çš„æ­£ç¡®æ–¹æ³•ï¼Œè€Œä¸æ˜¯å–æ¶ˆå¯¼èˆªã€‚

### è‡ªå®šä¹‰äº‹ä»¶[#](https://single-spa.js.org/docs/api/#custom-events)

single-spa å‘å°„äº†ä¸€ç³»åˆ— [custom events](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent)æ¯å½“å®ƒé‡æ–°è·¯ç”±ã€‚æ¯å½“æµè§ˆå™¨ URL ä»¥ä»»ä½•æ–¹å¼æ›´æ”¹æˆ–**triggerAppChange**å«åšã€‚è‡ªå®šä¹‰äº‹ä»¶è¢«è§¦å‘åˆ°**window**. æ¯ä¸ªè‡ªå®šä¹‰äº‹ä»¶éƒ½æœ‰ä¸€ä¸ª[**detail** property](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail) å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

```javascript
window.addEventListener('single-spa:before-routing-event', evt => {
  const {
    originalEvent,
    newAppStatuses,
    appsByNewStatus,
    totalAppChanges,
    oldUrl,
    newUrl,
    navigationIsCanceled,
    cancelNavigation,
  } = evt.detail;
  console.log(
    'original event that triggered this single-spa event',
    originalEvent,
  ); // PopStateEvent | HashChangeEvent | undefined
  console.log(
    'the new status for all applications after the reroute finishes',
    newAppStatuses,
  ); // { app1: MOUNTED, app2: NOT_MOUNTED }
  console.log(
    'the applications that changed, grouped by their status',
    appsByNewStatus,
  ); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }
  console.log(
    'number of applications that changed status so far during this reroute',
    totalAppChanges,
  ); // 2
  console.log('the URL before the navigationEvent', oldUrl); // http://localhost:8080/old-route
  console.log('the URL after the navigationEvent', newUrl); // http://localhost:8080/new-route
  console.log('has the navigation been canceled', navigationIsCanceled); // false

  // The cancelNavigation function is only defined in the before-routing-event
  evt.detail.cancelNavigation();
});
```

ä¸‹è¡¨æ˜¾ç¤ºäº†åœ¨é‡æ–°è·¯ç”±æœŸé—´è§¦å‘è‡ªå®šä¹‰äº‹ä»¶çš„é¡ºåºï¼š

| äº‹ä»¶é¡ºåº | äº‹ä»¶åç§°                                                     | å°„å‡»æ¡ä»¶                       |
| -------- | ------------------------------------------------------------ | ------------------------------ |
| 1        | **single-spa:before-app-change** æˆ–è€… **single-spa:before-no-app-change** | ä»»ä½•ç”³è¯·éƒ½ä¼šæ”¹å˜çŠ¶æ€å—ï¼Ÿ       |
| 2        | **single-spa:before-routing-event**                          | â€”                              |
| 3        | **single-spa:before-mount-routing-event**                    | â€”                              |
| 4        | **single-spa:before-first-mount**                            | è¿™æ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ä»»ä½•åº”ç”¨ç¨‹åºå—ï¼Ÿ |
| 5        | **single-spa:first-mount**                                   | è¿™æ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ä»»ä½•åº”ç”¨ç¨‹åºå—ï¼Ÿ |
| 6        | **single-spa:app-change** æˆ–è€… **single-spa:no-app-change**  | æ˜¯å¦æœ‰ä»»ä½•åº”ç”¨ç¨‹åºæ›´æ”¹äº†çŠ¶æ€ï¼Ÿ |
| 7        | **single-spa:routing-event**                                 | â€”                              |

### åº”ç”¨æ›´æ”¹å‰äº‹ä»¶[#](https://single-spa.js.org/docs/api/#before-app-change-event)

```javascript
window.addEventListener('single-spa:before-app-change', evt => {
  console.log('single-spa is about to mount/unmount applications!');
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: [] }
  console.log(evt.detail.totalAppChanges); // 1
});
```

ä¸€ç§ **single-spa:before-app-change** åœ¨é‡æ–°è·¯ç”±ä¹‹å‰è§¦å‘äº‹ä»¶ï¼Œè¿™å°†å¯¼è‡´è‡³å°‘ä¸€ä¸ªåº”ç”¨ç¨‹åºæ›´æ”¹çŠ¶æ€ã€‚

### æ— åº”ç”¨æ›´æ”¹å‰[#](https://single-spa.js.org/docs/api/#before-no-app-change)

```javascript
window.addEventListener('single-spa:before-no-app-change', evt => {
  console.log('single-spa is about to do a no-op reroute');
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }
  console.log(evt.detail.totalAppChanges); // 0
});
```

ä¸€ç§ **single-spa:before-no-app-change** äº‹ä»¶åœ¨é‡æ–°è·¯ç”±ä¹‹å‰è§¦å‘ï¼Œè¿™å°†å¯¼è‡´é›¶åº”ç”¨ç¨‹åºæ›´æ”¹çŠ¶æ€ã€‚

### è·¯ç”±äº‹ä»¶å‰[#](https://single-spa.js.org/docs/api/#before-routing-event)

```javascript
window.addEventListener('single-spa:before-routing-event', evt => {
  console.log('single-spa is about to mount/unmount applications!');
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }
  console.log(evt.detail.totalAppChanges); // 0
});
```

ä¸€ç§ **single-spa:before-routing-event** äº‹ä»¶åœ¨æ¯ä¸ªè·¯ç”±äº‹ä»¶å‘ç”Ÿä¹‹å‰è§¦å‘ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¯ä¸ª hashchangeã€popstate æˆ– triggerAppChange ä¹‹åï¼Œå³ä½¿ä¸éœ€è¦å¯¹æ³¨å†Œçš„åº”ç”¨ç¨‹åºè¿›è¡Œæ›´æ”¹ã€‚

### å®‰è£…å‰è·¯ç”±äº‹ä»¶[#](https://single-spa.js.org/docs/api/#before-mount-routing-event)

```javascript
window.addEventListener('single-spa:before-mount-routing-event', evt => {
  console.log('single-spa is about to mount/unmount applications!');
  console.log(evt.detail);
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: [] }
  console.log(evt.detail.totalAppChanges); // 1
});
```

ä¸€ç§ **single-spa:before-mount-routing-event** äº‹ä»¶åœ¨ä¹‹åè§¦å‘ **before-routing-event** å’Œä¹‹å‰ **routing-event**. å®ƒä¿è¯åœ¨å¸è½½æ‰€æœ‰single-spaåº”ç”¨ç¨‹åºä¹‹åï¼Œä½†åœ¨å®‰è£…ä»»ä½•æ–°åº”ç”¨ç¨‹åºä¹‹å‰è§¦å‘ã€‚

### é¦–æ¬¡å®‰è£…å‰[#](https://single-spa.js.org/docs/api/#before-first-mount)

```javascript
window.addEventListener('single-spa:before-first-mount', () => {
  console.log(
    'single-spa is about to mount the very first application for the first time',
  );
});
```

åœ¨å®‰è£…ç¬¬ä¸€ä¸ª single-spa åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œsingle-spa ä¼šè§¦å‘ä¸€ä¸ª **single-spa:before-first-mount**äº‹ä»¶; å› æ­¤å®ƒåªä¼šè¢«å‘å°„ä¸€æ¬¡ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒåœ¨åº”ç”¨ç¨‹åºå·²ç»åŠ è½½ä¹‹åä½†åœ¨å®‰è£…ä¹‹å‰è§¦å‘ã€‚

##### å»ºè®®ç”¨ä¾‹

åœ¨å®‰è£…ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºä¹‹å‰åˆ é™¤ç”¨æˆ·çœ‹åˆ°çš„åŠ è½½å™¨æ ã€‚

### é¦–æ¬¡å®‰è£…[#](https://single-spa.js.org/docs/api/#first-mount)

```javascript
window.addEventListener('single-spa:first-mount', () => {
  console.log('single-spa just mounted the very first application');
});
```

åœ¨å®‰è£…ç¬¬ä¸€ä¸ª single-spa åº”ç”¨ç¨‹åºåï¼Œsingle-spa ä¼šè§¦å‘ä¸€ä¸ª **single-spa:first-mount**äº‹ä»¶; å› æ­¤å®ƒåªä¼šè¢«å‘å°„ä¸€æ¬¡ã€‚

##### å»ºè®®ç”¨ä¾‹

è®°å½•ç”¨æˆ·çœ‹åˆ°ä»»ä½•å®‰è£…çš„åº”ç”¨ç¨‹åºä¹‹å‰èŠ±è´¹çš„æ—¶é—´ã€‚

### åº”ç”¨æ›´æ”¹äº‹ä»¶[#](https://single-spa.js.org/docs/api/#app-change-event)

```javascript
window.addEventListener('single-spa:app-change', evt => {
  console.log(
    'A routing event occurred where at least one application was mounted/unmounted',
  );
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED, app2: NOT_MOUNTED }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }
  console.log(evt.detail.totalAppChanges); // 2
});
```

ä¸€ç§ **single-spa:app-change**æ¯æ¬¡åŠ è½½ã€å¼•å¯¼ã€å®‰è£…ã€å¸è½½æˆ–å¸è½½ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ç¨‹åºæ—¶éƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚å®ƒç±»ä¼¼äº**single-spa:routing-event**é™¤äº†ä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ç¨‹åºå®é™…åŠ è½½ã€å¼•å¯¼ã€æŒ‚è½½æˆ–å¸è½½æ—¶å®ƒä¸ä¼šè§¦å‘ã€‚ä¸ä¼šå¯¼è‡´è¿™äº›æ›´æ”¹ä¹‹ä¸€çš„ hashchangeã€popstate æˆ– triggerAppChange ä¸ä¼šå¯¼è‡´äº‹ä»¶è¢«è§¦å‘ã€‚

### æ— åº”ç”¨æ›´æ”¹äº‹ä»¶[#](https://single-spa.js.org/docs/api/#no-app-change-event)

```javascript
window.addEventListener('single-spa:no-app-change', evt => {
  console.log(
    'A routing event occurred where zero applications were mounted/unmounted',
  );
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }
  console.log(evt.detail.totalAppChanges); // 0
});
```

å½“æ²¡æœ‰åº”ç”¨ç¨‹åºè¢«åŠ è½½ã€å¼•å¯¼ã€æŒ‚è½½ã€å¸è½½æˆ–å¸è½½æ—¶ï¼Œsingle-spa ä¼šè§¦å‘ä¸€ä¸ª **single-spa:no-app-change**äº‹ä»¶ã€‚è¿™æ˜¯ç›¸åçš„**single-spa:app-change**äº‹ä»¶ã€‚æ¯ä¸ªè·¯ç”±äº‹ä»¶åªä¼šè§¦å‘ä¸€ä¸ªã€‚

### è·¯ç”±äº‹ä»¶[#](https://single-spa.js.org/docs/api/#routing-event)

```javascript
window.addEventListener('single-spa:routing-event', evt => {
  console.log('single-spa finished mounting/unmounting applications!');
  console.log(evt.detail.originalEvent); // PopStateEvent
  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED, app2: NOT_MOUNTED }
  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }
  console.log(evt.detail.totalAppChanges); // 2
});
```

ä¸€ç§ **single-spa:routing-event**æ¯æ¬¡å‘ç”Ÿè·¯ç”±äº‹ä»¶æ—¶éƒ½ä¼šè§¦å‘äº‹ä»¶ï¼Œå³åœ¨æ¯æ¬¡ hashchangeã€popstate æˆ– triggerAppChange ä¹‹åï¼Œå³ä½¿ä¸éœ€è¦æ›´æ”¹å·²æ³¨å†Œçš„åº”ç”¨ç¨‹åºï¼›åœ¨ single-spa éªŒè¯æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å·²æ­£ç¡®åŠ è½½ã€å¼•å¯¼ã€æŒ‚è½½å’Œå¸è½½ä¹‹åã€‚
